-- JHUB Mega Script v4 | Part 1
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- ===== GUI =====
local gui = Instance.new("ScreenGui")
gui.Name = "JHUB"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local main = Instance.new("Frame")
main.Size = UDim2.new(0, 340, 0, 350)
main.Position = UDim2.new(0.5, -170, 0.5, -175)
main.BackgroundColor3 = Color3.fromRGB(18,18,18)
main.BorderSizePixel = 0
main.Parent = gui
Instance.new("UICorner", main).CornerRadius = UDim.new(0,14)

local top = Instance.new("Frame")
top.Size = UDim2.new(1,0,0,45)
top.BackgroundColor3 = Color3.fromRGB(25,25,25)
top.Parent = main
Instance.new("UICorner", top).CornerRadius = UDim.new(0,14)

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1,0,1,0)
title.Text = "JHUB"
title.Font = Enum.Font.GothamBold
title.TextSize = 22
title.TextColor3 = Color3.fromRGB(255,255,255)
title.BackgroundTransparency = 1
title.Parent = top

-- ===== DRAG UI =====
do
	local dragging, dragStart, startPos
	top.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = true
			dragStart = input.Position
			startPos = main.Position
		end
	end)
	UIS.InputChanged:Connect(function(input)
		if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
			local delta = input.Position - dragStart
			main.Position = UDim2.new(
				startPos.X.Scale,
				startPos.X.Offset + delta.X,
				startPos.Y.Scale,
				startPos.Y.Offset + delta.Y
			)
		end
	end)
	UIS.InputEnded:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			dragging = false
		end
	end)
end

-- ===== TABS =====
local tabBar = Instance.new("Frame")
tabBar.Size = UDim2.new(1,0,0,40)
tabBar.Position = UDim2.new(0,0,0,45)
tabBar.BackgroundTransparency = 1
tabBar.Parent = main

local function createTab(text, x)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.45,0,1,0)
	btn.Position = UDim2.new(x,0,0,0)
	btn.Text = text
	btn.Font = Enum.Font.Gotham
	btn.TextSize = 16
	btn.TextColor3 = Color3.fromRGB(255,255,255)
	btn.BackgroundColor3 = Color3.fromRGB(35,35,35)
	btn.Parent = tabBar
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0,10)
	return btn
end

local movementTabBtn = createTab("Movement", 0.03)
local playerTabBtn = createTab("Player", 0.52)

local content = Instance.new("Frame")
content.Size = UDim2.new(1,0,1,-85)
content.Position = UDim2.new(0,0,0,85)
content.BackgroundTransparency = 1
content.Parent = main

local movementTab = Instance.new("Frame", content)
movementTab.Size = UDim2.new(1,0,1,0)
movementTab.BackgroundTransparency = 1

local playerTab = Instance.new("Frame", content)
playerTab.Size = UDim2.new(1,0,1,0)
playerTab.BackgroundTransparency = 1
playerTab.Visible = false

local function showTab(tab)
	movementTab.Visible = false
	playerTab.Visible = false
	tab.Visible = true
end

movementTabBtn.MouseButton1Click:Connect(function() showTab(movementTab) end)
playerTabBtn.MouseButton1Click:Connect(function() showTab(playerTab) end)

-- ===== RAINBOW UI =====
do
	spawn(function()
		local hue = 0
		while true do
			local color = Color3.fromHSV(hue,1,1)
			main.BackgroundColor3 = color
			top.BackgroundColor3 = color
			for _, btn in pairs(main:GetDescendants()) do
				if btn:IsA("TextButton") then
					btn.BackgroundColor3 = color
				end
			end
			hue = hue + 0.005
			if hue > 1 then hue = 0 end
			task.wait(0.03)
		end
	end)
end

-- ===== HELPER =====
local function getHumanoid()
	local char = player.Character or player.CharacterAdded:Wait()
	local hum = char:WaitForChild("Humanoid")
	local root = char:WaitForChild("HumanoidRootPart")
	return hum, root
end

-- ===== MOVEMENT TAB =====
local currentSpeed = 16
local currentJump = 50
local wallJumpEnabled = false

-- Speed Label
local speedLabel = Instance.new("TextLabel")
speedLabel.Size = UDim2.new(1,0,0,30)
speedLabel.Position = UDim2.new(0,0,0.05,0)
speedLabel.Text = "Speed: "..currentSpeed
speedLabel.Font = Enum.Font.GothamBold
speedLabel.TextSize = 18
speedLabel.TextColor3 = Color3.fromRGB(255,255,255)
speedLabel.BackgroundTransparency = 1
speedLabel.Parent = movementTab

-- Speed Buttons
do
	local minus = Instance.new("TextButton")
	minus.Size = UDim2.new(0.35,0,0,45)
	minus.Position = UDim2.new(0.1,0,0.15,0)
	minus.Text = "-"
	minus.Font = Enum.Font.GothamBold
	minus.TextSize = 28
	minus.TextColor3 = Color3.fromRGB(255,255,255)
	minus.BackgroundColor3 = Color3.fromRGB(40,40,40)
	minus.Parent = movementTab
	Instance.new("UICorner", minus).CornerRadius = UDim.new(0,10)

	local plus = Instance.new("TextButton")
	plus.Size = UDim2.new(0.35,0,0,45)
	plus.Position = UDim2.new(0.55,0,0.15,0)
	plus.Text = "+"
	plus.Font = Enum.Font.GothamBold
	plus.TextSize = 28
	plus.TextColor3 = Color3.fromRGB(255,255,255)
	plus.BackgroundColor3 = Color3.fromRGB(40,40,40)
	plus.Parent = movementTab
	Instance.new("UICorner", plus).CornerRadius = UDim.new(0,10)

	minus.MouseButton1Click:Connect(function()
		currentSpeed = math.max(8, currentSpeed - 2)
		local hum,_ = getHumanoid()
		hum.WalkSpeed = currentSpeed
		speedLabel.Text = "Speed: "..currentSpeed
	end)
	plus.MouseButton1Click:Connect(function()
		currentSpeed = math.min(80, currentSpeed + 2)
		local hum,_ = getHumanoid()
		hum.WalkSpeed = currentSpeed
		speedLabel.Text = "Speed: "..currentSpeed
	end)
end

-- Booster Button
do
	local boosterBtn = Instance.new("TextButton")
	boosterBtn.Size = UDim2.new(0.8,0,0,45)
	boosterBtn.Position = UDim2.new(0.1,0,0.3,0)
	boosterBtn.Text = "Booster (58)"
	boosterBtn.Font = Enum.Font.GothamBold
	boosterBtn.TextSize = 18
	boosterBtn.TextColor3 = Color3.fromRGB(255,255,255)
	boosterBtn.BackgroundColor3 = Color3.fromRGB(170,0,255)
	boosterBtn.Parent = movementTab
	Instance.new("UICorner", boosterBtn).CornerRadius = UDim.new(0,10)

	boosterBtn.MouseButton1Click:Connect(function()
		currentSpeed = 58
		local hum,_ = getHumanoid()
		hum.WalkSpeed = currentSpeed
		speedLabel.Text = "Speed: "..currentSpeed
	end)
end

-- Jump Height
do
	local jumpLabel = Instance.new("TextLabel")
	jumpLabel.Size = UDim2.new(1,0,0,30)
	jumpLabel.Position = UDim2.new(0,0,0.45,0)
	jumpLabel.Text = "Jump: "..currentJump
	jumpLabel.Font = Enum.Font.GothamBold
	jumpLabel.TextSize = 16
	jumpLabel.TextColor3 = Color3.fromRGB(255,255,255)
	jumpLabel.BackgroundTransparency = 1
	jumpLabel.TextXAlignment = Enum.TextXAlignment.Left
	jumpLabel.Parent = movementTab

	local jumpMinus = Instance.new("TextButton")
	jumpMinus.Size = UDim2.new(0.35,0,0,45)
	jumpMinus.Position = UDim2.new(0.1,0,0.5,0)
	jumpMinus.Text = "-"
	jumpMinus.Font = Enum.Font.GothamBold
	jumpMinus.TextSize = 28
	jumpMinus.TextColor3 = Color3.fromRGB(255,255,255)
	jumpMinus.BackgroundColor3 = Color3.fromRGB(40,40,40)
	jumpMinus.Parent = movementTab
	Instance.new("UICorner", jumpMinus).CornerRadius = UDim.new(0,10)

	local jumpPlus = Instance.new("TextButton")
	jumpPlus.Size = UDim2.new(0.35,0,0,45)
	jumpPlus.Position = UDim2.new(0.55,0,0.5,0)
	jumpPlus.Text = "+"
	jumpPlus.Font = Enum.Font.GothamBold
	jumpPlus.TextSize = 28
	jumpPlus.TextColor3 = Color3.fromRGB(255,255,255)
	jumpPlus.BackgroundColor3 = Color3.fromRGB(40,40,40)
	jumpPlus.Parent = movementTab
	Instance.new("UICorner", jumpPlus).CornerRadius = UDim.new(0,10)

	jumpMinus.MouseButton1Click:Connect(function()
		currentJump = math.max(20, currentJump - 5)
		local hum,_ = getHumanoid()
		hum.JumpPower = currentJump
		jumpLabel.Text = "Jump: "..currentJump
	end)
	jumpPlus.MouseButton1Click:Connect(function()
		currentJump = math.min(150, currentJump + 5)
		local hum,_ = getHumanoid()
		hum.JumpPower = currentJump
		jumpLabel.Text = "Jump: "..currentJump
	end)
end

-- Wall Jump
do
	local wallJumpBtn = Instance.new("TextButton")
	wallJumpBtn.Size = UDim2.new(0.8,0,0,45)
	wallJumpBtn.Position = UDim2.new(0.1,0,0.65,0)
	wallJumpBtn.Text = "Wall Jump: OFF"
	wallJumpBtn.Font = Enum.Font.GothamBold
	wallJumpBtn.TextSize = 18
	wallJumpBtn.TextColor3 = Color3.fromRGB(255,255,255)
	wallJumpBtn.BackgroundColor3 = Color3.fromRGB(0,170,255)
	wallJumpBtn.Parent = movementTab
	Instance.new("UICorner", wallJumpBtn).CornerRadius = UDim.new(0,10)

	wallJumpBtn.MouseButton1Click:Connect(function()
		wallJumpEnabled = not wallJumpEnabled
		if wallJumpEnabled then
			wallJumpBtn.Text = "Wall Jump: ON"
			wallJumpBtn.BackgroundColor3 = Color3.fromRGB(0,255,170)
		else
			wallJumpBtn.Text = "Wall Jump: OFF"
			wallJumpBtn.BackgroundColor3 = Color3.fromRGB(0,170,255)
		end
	end)
end

-- Wall Jump Logic
RunService.RenderStepped:Connect(function()
	if wallJumpEnabled then
		local hum, root = getHumanoid()
		if UIS:IsKeyDown(Enum.KeyCode.Space) then
			local nearWall = false
			local directions = {Vector3.new(4,0,0), Vector3.new(-4,0,0), Vector3.new(0,0,4), Vector3.new(0,0,-4)}
			for _, dir in pairs(directions) do
				local ray = Ray.new(root.Position, dir)
				local part = workspace:FindPartOnRayWithIgnoreList(ray, {player.Character})
				if part then nearWall = true break end
			end
			if nearWall then
				hum:ChangeState(Enum.HumanoidStateType.Jumping)
				hum.JumpPower = currentJump*1.2
			else
				hum.JumpPower = currentJump
			end
		else
			hum.JumpPower = currentJump
		end
	end
end)

-- ===== PLAYER TAB =====
local followPlatform
local following = false

local function makeRainbowPlatform(platform)
	local hue = 0
	spawn(function()
		while platform and platform.Parent do
			platform.Color = Color3.fromHSV(hue,1,1)
			hue = hue + 0.005
			if hue > 1 then hue = 0 end
			task.wait(0.03)
		end
	end)
end

-- Platform Button
local platformBtn = Instance.new("TextButton")
platformBtn.Size = UDim2.new(0.8,0,0,45)
platformBtn.Position = UDim2.new(0.1,0,0.15,0)
platformBtn.Text = "Platform"
platformBtn.Font = Enum.Font.GothamBold
platformBtn.TextSize = 18
platformBtn.TextColor3 = Color3.fromRGB(255,255,255)
platformBtn.BackgroundColor3 = Color3.fromRGB(0,120,255)
platformBtn.Parent = playerTab
Instance.new("UICorner", platformBtn).CornerRadius = UDim.new(0,10)

platformBtn.MouseButton1Click:Connect(function()
	local _, root = getHumanoid()
	if followPlatform then followPlatform:Destroy() end
	local platform = Instance.new("Part")
	platform.Size = Vector3.new(120,2,120)
	platform.Anchored = true
	platform.CanCollide = true
	platform.Material = Enum.Material.SmoothPlastic
	platform.CFrame = root.CFrame * CFrame.new(0,-4,0)
	platform.Parent = workspace
	followPlatform = platform
	makeRainbowPlatform(platform)
end)

-- Follow Platform Button
local followBtn = Instance.new("TextButton")
followBtn.Size = UDim2.new(0.8,0,0,45)
followBtn.Position = UDim2.new(0.1,0,0.3,0)
followBtn.Text = "Follow Platform"
followBtn.Font = Enum.Font.GothamBold
followBtn.TextSize = 18
followBtn.TextColor3 = Color3.fromRGB(255,255,255)
followBtn.BackgroundColor3 = Color3.fromRGB(0,255,170)
followBtn.Parent = playerTab
Instance.new("UICorner", followBtn).CornerRadius = UDim.new(0,10)

followBtn.MouseButton1Click:Connect(function()
	local _, root = getHumanoid()
	if following then
		following = false
		if followPlatform then followPlatform:Destroy() end
	else
		if followPlatform then followPlatform:Destroy() end
		local platform = Instance.new("Part")
		platform.Size = Vector3.new(120,2,120)
		platform.Anchored = true
		platform.CanCollide = true
		platform.Material = Enum.Material.SmoothPlastic
		platform.CFrame = root.CFrame * CFrame.new(0,-4,0)
		platform.Parent = workspace
		followPlatform = platform
		makeRainbowPlatform(platform)
		following = true
		spawn(function()
			while following and followPlatform and root.Parent do
				followPlatform.CFrame = CFrame.new(root.Position.X, root.Position.Y-4, root.Position.Z)
				task.wait(0.03)
			end
		end)
	end
end)

-- ===== SELF-LAG =====
local lagBtn = Instance.new("TextButton")
lagBtn.Size = UDim2.new(0.8,0,0,45)
lagBtn.Position = UDim2.new(0.1,0,0.45,0)
lagBtn.Text = "Self Lag: OFF"
lagBtn.Font = Enum.Font.GothamBold
lagBtn.TextSize = 18
lagBtn.TextColor3 = Color3.fromRGB(255,255,255)
lagBtn.BackgroundColor3 = Color3.fromRGB(170,0,0)
lagBtn.Parent = playerTab
Instance.new("UICorner", lagBtn).CornerRadius = UDim.new(0,10)

local lagging = false
local lagConnection
local Camera = workspace.CurrentCamera

local function startLag()
	lagConnection = RunService.RenderStepped:Connect(function()
		Camera.CFrame = Camera.CFrame * CFrame.new(math.random(-2,2)/10,math.random(-2,2)/10,0)
		task.wait(math.random(0,3)/20)
	end)
end

local function stopLag()
	if lagConnection then lagConnection:Disconnect() end
end

lagBtn.MouseButton1Click:Connect(function()
	lagging = not lagging
	if lagging then
		lagBtn.Text = "Self Lag: ON"
		lagBtn.BackgroundColor3 = Color3.fromRGB(200,0,0)
		startLag()
	else
		lagBtn.Text = "Self Lag: OFF"
		lagBtn.BackgroundColor3 = Color3.fromRGB(170,0,0)
		stopLag()
	end
end)

-- ===== FPS COUNTER =====
local fpsLabel = Instance.new("TextLabel")
fpsLabel.Size = UDim2.new(0,100,0,30)
fpsLabel.Position = UDim2.new(0.01,0,0.95,0)
fpsLabel.BackgroundTransparency = 0.5
fpsLabel.BackgroundColor3 = Color3.fromRGB(0,0,0)
fpsLabel.TextColor3 = Color3.fromRGB(255,255,255)
fpsLabel.TextSize = 14
fpsLabel.Font = Enum.Font.GothamBold
fpsLabel.Text = "FPS: 0"
fpsLabel.Parent = gui
Instance.new("UICorner", fpsLabel).CornerRadius = UDim.new(0,6)

local lastTime = tick()
local frames = 0
RunService.RenderStepped:Connect(function()
	frames = frames + 1
	if tick() - lastTime >= 1 then
		fpsLabel.Text = "FPS: "..frames
		frames = 0
		lastTime = tick()
	end
end)

-- ===== RESPAWN SAFE =====
player.CharacterAdded:Connect(function()
	task.wait(1)
	local hum,_ = getHumanoid()
	hum.WalkSpeed = currentSpeed
	hum.JumpPower = currentJump
end)
